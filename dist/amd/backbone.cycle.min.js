// Backbone.Cycle, v2.0.0
// Copyright (c)2015 Michael Heim, Zeilenwechsel.de
// Distributed under MIT license
// http://github.com/hashchange/backbone.cycle


!function(a,b){"use strict";"object"==typeof exports?module.exports=b(require("underscore"),require("backbone"),require("backbone.select")):"function"==typeof define&&define.amd&&define(["underscore","backbone","backbone.select"],b)}(this,function(_,Backbone){"use strict";return function(Backbone,_){function a(a,b){var c=a%b.length;return 0>c&&(c=b.length+c),b.at(c)}function b(a){return!isNaN(a)&&parseInt(Number(a),10)==a&&!isNaN(parseInt(a,10))}function c(a,b){return"first"===a?0:"last"===a?b.length-1:parseInt(a,10)}var d={Model:{ahead:function(b,c){var d=c||this.collection,e=d.indexOf(this);if(-1===e)throw new Error("Model "+this.cid+"doesn't exist in the collection.");return a(e+b,d)},behind:function(a,b){return this.ahead(-a,b)},next:function(a){return this.ahead(1,a)},prev:function(a){return this.behind(1,a)},aheadNoLoop:function(a,b){var c=b||this.collection,d=c.indexOf(this);if(-1===d)throw new Error("Model "+this.cid+"doesn't exist in the collection.");return c.at(d+a)},behindNoLoop:function(a,b){return this.aheadNoLoop(-a,b)},nextNoLoop:function(a){return this.aheadNoLoop(1,a)},prevNoLoop:function(a){return this.behindNoLoop(1,a)},_cycleType:"Backbone.Cycle.Model"},SelectableCollection:{selectAt:function(a){var b=this.at(a);if(!b)throw new Error("Model with index "+a+" doesn't exist in the collection and can't be selected.");b.select()},selectNext:function(){return this.next().select(),this},selectPrev:function(){return this.prev().select(),this},selectNextNoLoop:function(){var a=this.nextNoLoop();return a&&a.select(),this},selectPrevNoLoop:function(){var a=this.prevNoLoop();return a&&a.select(),this},ahead:function(b){if(!this.selected)throw new Error("Illegal call of SelectableCollection navigation method. No model had been selected to begin with.");return a(this.indexOf(this.selected)+b,this)},behind:function(a){return this.ahead(-a)},next:function(){return this.ahead(1)},prev:function(){return this.behind(1)},aheadNoLoop:function(a){if(!this.selected)throw new Error("Illegal call of SelectableCollection navigation method. No model had been selected to begin with.");return this.at(this.indexOf(this.selected)+a)},behindNoLoop:function(a){return this.aheadNoLoop(-a)},nextNoLoop:function(){return this.aheadNoLoop(1)},prevNoLoop:function(){return this.behindNoLoop(1)},selectInitial:function(){var a,b=arguments.length&&!(arguments[0]instanceof Backbone.Model);!this.length||this.selected||this._cycle_skipSelectInitial||"none"===this.autoSelect||(a=c(this.autoSelect,this.models),b||this.find(function(a){return a.selected})&&(this._cycle_skipSelectInitial=!0),this.at(a)&&!this._cycle_skipSelectInitial&&this.selectAt(a)),this.selected&&this._cycle_skipSelectInitial&&delete this._cycle_skipSelectInitial},selectOnRemove:function(b,c,d){var e,f;d||(d={}),"remove"===d._externalEvent&&(this.selectIfRemoved&&"none"===this.selectIfRemoved||!this.length||(f=d.index,e=-1!==this.selectIfRemoved.indexOf("next")?f:f-1,-1!==this.selectIfRemoved.indexOf("NoLoop")&&(e=Math.max(Math.min(e,this.length-1),0)),a(e,this).select()))},_cycleType:"Backbone.Cycle.SelectableCollection"}};Backbone.Cycle={Model:{applyTo:function(a){_.extend(a,d.Model)}},SelectableModel:{applyTo:function(a){Backbone.Select.Me.applyTo(a),_.extend(a,d.Model,{_cycleType:"Backbone.Cycle.SelectableModel"})}},SelectableCollection:{applyTo:function(a,e,f){var g,h,i,j;if(arguments.length<2)throw new Error("The `models` parameter has not been passed to Backbone.Cycle.SelectableCollection.applyTo. Its value can be undefined if no models are passed in during instantiation, but even so, it must be provided.");if(f||(f={}),a.autoSelect=f.autoSelect||f.initialSelection||"none",a.selectIfRemoved=f.selectIfRemoved||"none",!_.contains(["first","last","none"],a.autoSelect)&&!b(a.autoSelect))throw new Error('Invalid autoSelect value "'+a.autoSelect+'"');if(!_.contains(["prev","next","prevNoLoop","nextNoLoop","none"],a.selectIfRemoved))throw new Error('Invalid selectIfRemoved value "'+a.selectIfRemoved+'"');g="none"!==a.autoSelect,h="none"!==a.selectIfRemoved,i=f.enableModelSharing||g||h,Backbone.Select.One.applyTo(a,e,{enableModelSharing:i}),_.extend(a,d.SelectableCollection),h&&a.listenTo(a,"deselect:one",a.selectOnRemove),g&&(!a.selected&&e&&e.length&&(j=c(a.autoSelect,e),e[j]&&(a.selected=e[j],e[j].select())),a.listenTo(a,"add",a.selectInitial),a.listenTo(a,"reset",a.selectInitial))}}}}(Backbone,_),Backbone.Cycle});
//# sourceMappingURL=backbone.cycle.min.js.map